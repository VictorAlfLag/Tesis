<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>

    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            // Cambia los datos según tus atributos de Proyecto
            var data = google.visualization.arrayToDataTable([
                ['Estado', 'Cantidad'],
                {% for proyectoTemporal in proyectos %}
                    ['{{ proyectoTemporal.estado }}', 1],
                {% endfor %}
            ]);

            // Agrupando los datos por estado
            var view = new google.visualization.DataView(data);
            var estadoCount = {};
            data.getFilteredRows([{column: 0}]).forEach(function(row) {
                var estado = data.getValue(row, 0);
                estadoCount[estado] = (estadoCount[estado] || 0) + 1;
            });

            var aggregatedData = [['Estado', 'Cantidad']];
            for (var estado in estadoCount) {
                aggregatedData.push([estado, estadoCount[estado]]);
            }

            var chartData = google.visualization.arrayToDataTable(aggregatedData);

            var options = {
                title: 'Cantidad de Proyectos por Estado',
                pieHole: 0.4,
            };

            var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
            chart.draw(chartData, options);
        }
    </script>
</body>
</html>
